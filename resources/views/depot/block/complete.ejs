

<%- include('../../_layouts/header.ejs') %>
<%- include('../../toast.ejs') %>
<section>
    <div class="container mx-auto pt-12">
        <div class="flex items-center justify-between mb-10">
            <h1 class="font-bold text-lg">Completed Orders (from Blockchain DB)</h1>
            <a href="/api/drug/depot/orders/blockchain"><h6 class="bg-white py-1 rounded-full px-4 text-green-700 text-l">Orders (from Blockchain DB)</h6></a>
        </div>
        <section class="transactionTable">
            <table class="customerT mx-auto table-auto bg-white">
                <thead>
                    <tr>
                        <th class="px-4 py-2 text-center">Block Hash</th>
                        <th class="px-4 py-2 text-center">Order ID</th>
                        <th class="px-4 py-2 text-center">Order Status</th>
                        <th class="px-4 py-2 text-center">Order DAR</th>
                        <th class="px-4 py-2 text-center">Order Role</th>
                        <th class="px-4 py-2 text-center">Block Number</th>
                        <th class="px-4 py-2 text-center">Gas Used</th>
                        <th class="px-4 py-2 text-center">To</th>
                        <th class="px-4 py-2 text-center">Pharmacist ID</th>
                        <th class="px-4 py-2 text-center">Transaction Hash</th>
                        <th class="px-4 py-2 text-center">Transaction Status</th>
                        <th class="px-4 py-2 text-center">Time</th>
                        <th class="px-4 py-2 text-center">Date</th>
                    </tr>
                </thead>
                <tbody>
                    <% if(orders.length) { %>
                        <% orders.forEach((order)=>{ %>
                            <% if(user._id.equals(order.orderID.senderId)) { %>
                            <tr>
                                <td class="border px-4 py-2 text-center">
                                    <%= order.blockHash %>
                                 </td>
            
                               <td class="border px-4 py-2 text-center">
                                <%= order.orderID._id %>
                              </td>
                              <td class="border px-4 py-2 text-center">
                                <%= order.orderstatus %>
                              </td>
                              <td class="border px-4 py-2 text-center">
                                <%= order.orderID.dar %>
                              </td>
                              <td class="border px-4 py-2 text-center">
                                <%= order.orderID.role %>
                              </td>

                               <td class="border px-4 py-2 text-center">
                                <%= order.blockNumber %>
                               </td>
                                <td class="border px-4 py-2 text-center">
                                    <%= order.gasUsed %>
                                </td>
                                <td class="border px-4 py-2 text-center">
                                    <%= order.to %>
                                </td>
                                <td class="border px-4 py-2 text-center">
                                    <%= order.orderID.pharmacistId %>
                                </td>
                                <td class="border px-4 py-2 text-center">
                                    <%= order.transactionHash %>
                                </td>
                                <td class="border px-4 py-2 text-center">
                                    <%= order.status %>
                                </td>
                                <td class="border px-4 py-2 text-center">
                                    <%= moment(order.createdAt).format('hh:mm A') %>
                                </td>  
                                <td class="border px-4 py-2 text-center">
                                    <%= moment(order.createdAt).format('MMMM Do YYYY') %>
                                </td>  
                            </tr>
                            <% }%>
                        <% }) %>
                        
                    <% } else { %>
                        <tr>
                            <td class="p-4">No orders found</td>
                        </tr>
                    <% } %>
                   
                </tbody>
            </table>
        </section>
    </div>

</section>



<script src="/socket.io/socket.io.js"></script>
<script src="/js/app.js" type="text/javascript" charset="utf-8"></script>